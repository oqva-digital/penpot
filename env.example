# ============================================
# Penpot Self-Hosted Configuration
# ============================================
# 
# This file is a template. Copy to .env.local and adjust the values.
# The .env.local file is automatically generated by the setup.sh script
# and should not be versioned in git.
#
# ============================================

# Penpot version to use
# Use "latest" for the most recent version or a specific tag (e.g., "2.8.1")
PENPOT_VERSION=latest

# Public URL where Penpot will be accessible
# IMPORTANT: Configure with the real domain that will be used via Cloudflare Tunnel
# Example: https://penpot.yourdomain.com
PENPOT_PUBLIC_URI=https://penpot.example.com

# Penpot master secret key (512 bits base64)
# This key is used to derive other keys (sessions, invitations, etc.)
# WILL BE GENERATED AUTOMATICALLY by the generate-secrets.sh script
# Format: base64 string of 64+ characters
PENPOT_SECRET_KEY=change-this-insecure-key

# Penpot feature flags
# Full documentation: https://help.penpot.app/technical-guide/configuration/#penpot-configuration
# 
# Common flags:
#   enable-login-with-password    - Enables login with email/password
#   enable-registration           - Allows registration of new users
#   enable-smtp                   - Enables email sending
#   enable-prepl-server           - Enables REPL server for development
#   disable-email-verification    - Disables email verification (NOT recommended for production)
#   disable-secure-session-cookies - Disables secure cookies (NOT recommended for production)
#   login-with-github             - Enables login via GitHub OAuth
#   login-with-google             - Enables login via Google OAuth
#   login-with-ldap               - Enables login via LDAP
#   login-with-oidc               - Enables login via OIDC
PENPOT_FLAGS=enable-login-with-password enable-smtp enable-prepl-server enable-registration

# Maximum HTTP request sizes
PENPOT_HTTP_SERVER_MAX_BODY_SIZE=31457280
PENPOT_HTTP_SERVER_MAX_MULTIPART_BODY_SIZE=367001600

# ============================================
# PostgreSQL Database Configuration
# ============================================

POSTGRES_DB=penpot
POSTGRES_USER=penpot
# WILL BE GENERATED AUTOMATICALLY by the generate-secrets.sh script
POSTGRES_PASSWORD=change-this-password

# Database connection URI (usually doesn't need to be changed)
PENPOT_DATABASE_URI=postgresql://penpot-postgres/penpot
PENPOT_DATABASE_USERNAME=penpot
# Can be different from POSTGRES_PASSWORD if needed
PENPOT_DATABASE_PASSWORD=${POSTGRES_PASSWORD}

# ============================================
# Valkey (Redis-compatible) Configuration
# ============================================

PENPOT_REDIS_URI=redis://penpot-valkey/0
VALKEY_MAXMEMORY=128mb

# ============================================
# Storage Configuration
# ============================================

# Storage backend: "fs" (filesystem) or "s3" (S3-compatible)
PENPOT_OBJECTS_STORAGE_BACKEND=fs
PENPOT_OBJECTS_STORAGE_FS_DIRECTORY=/opt/data/assets

# If using S3, uncomment and configure:
# PENPOT_OBJECTS_STORAGE_BACKEND=s3
# AWS_ACCESS_KEY_ID=your-access-key
# AWS_SECRET_ACCESS_KEY=your-secret-key
# PENPOT_STORAGE_ASSETS_S3_ENDPOINT=https://s3.amazonaws.com
# PENPOT_STORAGE_ASSETS_S3_BUCKET=penpot-assets

# ============================================
# SMTP (Email) Configuration
# ============================================

# For production, configure a real SMTP provider
# mailcatch is only for development/testing

PENPOT_SMTP_DEFAULT_FROM=no-reply@example.com
PENPOT_SMTP_DEFAULT_REPLY_TO=no-reply@example.com
PENPOT_SMTP_HOST=penpot-mailcatch
PENPOT_SMTP_PORT=1025
PENPOT_SMTP_USERNAME=
PENPOT_SMTP_PASSWORD=
PENPOT_SMTP_TLS=false
PENPOT_SMTP_SSL=false

# Example configuration for Gmail:
# PENPOT_SMTP_HOST=smtp.gmail.com
# PENPOT_SMTP_PORT=587
# PENPOT_SMTP_USERNAME=your-email@gmail.com
# PENPOT_SMTP_PASSWORD=your-app-password
# PENPOT_SMTP_TLS=true
# PENPOT_SMTP_SSL=false

# Example configuration for SendGrid:
# PENPOT_SMTP_HOST=smtp.sendgrid.net
# PENPOT_SMTP_PORT=587
# PENPOT_SMTP_USERNAME=apikey
# PENPOT_SMTP_PASSWORD=SG.your-api-key-here
# PENPOT_SMTP_TLS=true

# ============================================
# Cloudflare Tunnel Configuration
# ============================================

# Cloudflare Tunnel token
# Obtain at: https://one.dash.cloudflare.com/ > Zero Trust > Access > Tunnels
# Create a new tunnel or use an existing one and copy the token
# 
# IMPORTANT: Configure the hostname in Cloudflare dashboard pointing to:
#   - Service: http://penpot-frontend:8080
#   - For WebSocket: http://penpot-frontend:8080/ws/*
CLOUDFLARE_TUNNEL_TOKEN=

# ============================================
# Optional Settings
# ============================================

# Telemetry (anonymous usage data)
PENPOT_TELEMETRY_ENABLED=true
PENPOT_TELEMETRY_REFERER=self-hosted

# Mailcatch port (web interface to view emails)
MAILCATCH_PORT=1080

# Docker Registry (if you want to push images)
# DOCKER_REGISTRY=registry.example.com

# ============================================
# Security Notes
# ============================================
#
# 1. NEVER commit the .env.local file to git
# 2. Keep PENPOT_SECRET_KEY and passwords secure
# 3. For production, remove the flags:
#    - disable-email-verification
#    - disable-secure-session-cookies
# 4. Configure real SMTP for production
# 5. Use HTTPS via Cloudflare Tunnel
# 6. Make regular backups of Docker volumes
#
